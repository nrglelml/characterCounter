{% extends "base.html" %} {% block content %}

<div class="text-center mb-5">
  <h1 class="page-title">Character Counter & Akademik Metin Özetleyici</h1>
  <p class="page-subtitle">
    Makale ve literatür taramalarınızı yapay zeka ile akıllıca özetleyin.
  </p>
</div>

<form method="POST" action="/" class="mb-4">
  <div class="row g-4">

    <div class="col-md-6">
      <div class="glass-box">
        <h4 class="mb-3">Metnini Yapıştır:</h4>

        <label class="form-label fw-bold">Metin:</label>
        <textarea
          id="inputText"
          name="text"
          class="form-control auto-grow"
          rows="7"
          placeholder="Metni buraya yapıştırın..."
          oninput="handleInput(this)"
        >
{{ text }}</textarea
        >

        <div class="text-end mt-2">
          <small
            >Mevcut Karakter:
            <strong id="currentCount">{{ karakter_sayisi or 0 }}</strong></small
          >
        </div>
      </div>
    </div>


    <div class="col-md-6">
      <div class="glass-box">
        <h4 class="mb-3">Metin İstatistikleri</h4>

        {% if kelime_sayisi %}
        <div class="stats-grid mb-4">
          <div class="stats-item">
            <h3>{{ kelime_sayisi }}</h3>
            <small>Kelime</small>
          </div>
          <div class="stats-item">
            <h3>{{ karakter_sayisi }}</h3>
            <small>Karakter</small>
          </div>
          <div class="stats-item">
            <h3>{{ cumle_sayisi }}</h3>
            <small>Cümle</small>
          </div>
          <div class="stats-item">
            <h3 class="text-success">
              {% if semantic_ozet and karakter_sayisi > 0 %} %{{ ((1 -
              (semantic_ozet|length / karakter_sayisi)) * 100) | round | int }}
              {% else %} 0 {% endif %}
            </h3>
            <small>Küçülme Oranı</small>
          </div>
        </div>
        <div class="mt-4">
          <label for="limitInput" class="fw-bold">Hedef Karakter Limiti:</label>
          <input
            type="number"
            id="limitInput"
            name="limit"
            class="form-control"
            placeholder="örn: 1000"
            value="{{ limit }}"
          />
          <small class="text-muted">Boş bırakılırsa otomatik özetlenir.</small>
        </div>

        <button type="submit" class="btn btn-primary w-100 mt-3 py-2">
          <i class="bi bi-magic"></i> Analiz Et ve Özetle
        </button>
        {% endif %} {% if kisaltma is not none or semantic_ozet %}
        <h5 class="mb-2">Çıktı</h5>

        <div class="output-box">
          <label class="fw-bold text-success mb-2 d-flex align-items-center">
            <i class="bi bi-robot me-2"></i> Yapay Zeka Özeti
          </label>

          <textarea
            readonly
            class="form-control auto-grow mb-4 border-success"
            style="
              border-width: 2px;
              line-height: 1.6;
              padding: 14px;
              font-size: 15px;
            "
          >
{{ semantic_ozet if semantic_ozet else "Özet oluşturulamadı." }}</textarea
          >


          {% if kisaltma %}
          <label class="fw-bold text-warning mb-2">Basit Kısaltma</label>
          <textarea
            readonly
            class="form-control auto-grow mb-2"
            style="
              background: rgba(255, 255, 255, 0.06);
              border: 1px solid rgba(255, 255, 255, 0.18);
              line-height: 1.55;
              padding: 12px;
              font-size: 14px;
            "
          >
{{ kisaltma }}</textarea
          >
          {% endif %}
        </div>
        {% endif %}
      </div>
    </div>
  </div>
</form>

<script>
  function autoResize(el) {
    el.style.height = "auto";
    el.style.height = el.scrollHeight + "px";
  }

  function handleInput(el) {
    document.getElementById("currentCount").innerText = el.value.length;
    autoResize(el);
  }

  document.addEventListener("DOMContentLoaded", function () {
    const inputText = document.getElementById("inputText");
    if (inputText && inputText.value.length > 0) {
      handleInput(inputText);
    }
    document.querySelectorAll(".auto-grow").forEach(autoResize);
  });
</script>

{% endblock %}
